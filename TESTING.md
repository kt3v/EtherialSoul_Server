# Быстрый старт для тестирования Phase 2

## Перед запуском

1. **Обновите .env файл:**
   ```bash
   cd /home/indie/Documents/Projects/EsoAgent2/server
   nano .env
   ```
   
   Убедитесь, что есть:
   ```
   GEMINI_API_KEY=ваш_ключ
   MAIN_MODEL=gemini-2.0-flash-exp
   EVALUATOR_MODEL=gemini-2.0-flash-thinking-exp-01-21
   PORT=3000
   ```

2. **Проверьте, что серверы запущены:**
   - Backend: `npm run dev` в `/server` ✓ (уже запущен)
   - Client: `npx expo start --clear` в `/client` ✓ (уже запущен)

## Что тестировать

### 1. Базовая отправка блоков
- Отправьте сообщение в чат
- Вы должны увидеть, как сообщения AI приходят по частям
- Каждый блок появляется с задержкой

### 2. Прерывание буфера
- Отправьте сообщение
- Пока идет отправка блоков, отправьте еще одно
- Система должна завершить текущую группу, затем обновить буфер

### 3. Таймеры печати
- Начните печатать (не отправляя)
- Остановитесь
- Через 5 секунд должен запуститься UpdateBuffer

### 4. EndUpdate таймер
- Отправьте сообщение
- Дождитесь полной отправки всех блоков
- Не отправляйте ничего 25 секунд
- Система автоматически обновит буфер

## Логи в консоли сервера

Ищите:
```
[StateOrchestrator] User message from ...
[GeminiService] Calling UpdateBuffer...
[GeminiService] UpdateBuffer successful: X blocks
[BufferManager] Sending block X, group Y
[TimerManager] Started ... timer
```

## Возможные проблемы

**Ошибка загрузки промптов:**
- Проверьте, что файлы `prompt.txt` и `evaluator_prompt.txt` находятся в корне проекта
- Путь должен быть: `/home/indie/Documents/Projects/EsoAgent2/prompt.txt`

**Ошибка Gemini API:**
- Проверьте API ключ
- Убедитесь, что модели доступны в вашем регионе
- Проверьте квоты API

**Блоки не приходят:**
- Откройте консоль браузера/приложения
- Проверьте WebSocket соединение
- Убедитесь, что событие `ai_block` обрабатывается

## Следующие шаги

После успешного тестирования:
1. Добавьте обработку ошибок для production
2. Реализуйте персистентное хранилище (Redis/DB)
3. Добавьте аутентификацию
4. Оптимизируйте промпты под ваши нужды
